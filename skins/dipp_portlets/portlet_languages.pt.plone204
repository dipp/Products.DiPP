<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:domain="plone">
<body>
<!-- This code is *really* messed up, and will be replaced in the next version of Plone. 
     Do not try to make sense of this.
-->
<div metal:define-macro="portlet"
       i18n:domain="plone"
       tal:omit-tag=""
       tal:define="portalObject portal;
                   lang request/other/LANGUAGE|nothing">
                   
    <div class="portlet" id="portlet-languages" >
    <div class="active">

        
        <div class="portletBody">
            <tal:block metal:define-macro="language"
                 tal:define="served_languages here/portal_languages/listSupportedLanguages;
                             boundLanguages here/portal_languages/getLanguageBindings;
                             prefLang python:boundLanguages[0];"
                 tal:omit-tag="">
            
                    <div class="portletContent lang" tal:condition="python:len(served_languages) >= 2">
                        <ul>
                            <li tal:repeat="lang served_languages"
                                tal:condition="here/portal_languages/showFlags">
                
                                <span tal:omit-tag="python:prefLang != lang[0]"
                                        tal:define="code python:lang[0]">
                
                                    <a href=""
                                       tal:attributes="href string:${here/absolute_url}/switchLanguage?set_language=${code};
                                                       title python:here.portal_languages.getNameForLanguageCode(lang[0]) or lang[1]">
                
                                        <img width="14" 
                                             height="11" 
                                             alt=""
                                             tal:condition="here/portal_languages/showFlags | nothing"
                                             tal:attributes="src string:${portal_url}/flag-${code}.gif;
                                                             title python: lang[1];" 
                                                             />
                                                             
                                    </a>
                
                                </span>    
                                
                            </li>
            
                            <li tal:condition="not: here/portal_languages/showFlags">
                                
                                    <select style="font-size: 94%;"
                                            onchange=""
                                            tal:attributes="onchange string:window.location='${here/absolute_url}/switchLanguage?set_language=' + this.options(this.selectedIndex).value" >
                                        <option tal:repeat="lang served_languages"
                                                tal:content="python:here.portal_languages.getNameForLanguageCode(lang[0]) or lang[1]"
                                                tal:attributes="selected python:prefLang == lang[0];
                                                                value python:lang[0]">Language</option>
                                    </select>
                
                            </li>
            
                        </ul>
                </div>
        
            </tal:block>
        </div>
    </div>
</div>
</div>
</body>
</html>
