<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="linguaplone">

<body>

   <div metal:fill-slot="main"
        tal:define="deletable_languages here/getDeletableLanguages;
                    untranslated_languages here/getUntranslatedLanguages">

        <h1 i18n:translate="header_link_translations">
            Link translations
        </h1>

        <p class="documentDescription"
           i18n:translate="description_link_translations">
            Here you can link the content language.
        </p>



        <h2 i18n:translate="header_link_translations">
            Link translations
        </h2>
        
<pre>
DEBUGGING
sprachen: <tal:block tal:replace="python:len(context.languageSelectorData())"/>
type: <tal:block tal:replace="here/portal_type"/>
canonical: <tal:block tal:replace="here/getCanonical"/>
</pre>

        <p tal:condition="untranslated_languages"
           i18n:translate="description_link_translations">
            Link another existing content as a translation for
            the current one in the selected language.
        </p>

        <p class="documentDescription"
           tal:condition="not:untranslated_languages"
           i18n:translate="description_no_linkable_translations">
            There is no untranslable language to link to.
        </p>

        <form name="linkTranslation"
              method="post"
              action=""
              class="group"
              tal:condition="untranslated_languages"
              tal:attributes="action here/absolute_url">
			
			
            <div class="field">
			
                <label for="link_language"
                       i18n:translate="label_link_language">Language</label>
			
                <div class="formHelp" i18n:translate="help_link_language">
                    Select the language that the translation will be linked as.
                </div>

                <div tal:repeat="lang untranslated_languages"
                     tal:define="content_language context/Language;
                     			 parent here/getParentNode;">
                     			 
                    <strong tal:content="python:'%s (%s)' % (lang[1], lang[0]) ">Deutsch (de)</strong>
                    
                	<tal:item tal:define="pfolder python: parent.getTranslation(lang[0]);
                						  physicalPath pfolder/getPhysicalPath|nothing">
                						  
                		<tal:block tal:condition="physicalPath">
                        
                			<ol>
	                		<tal:block tal:define="path python:'/'.join(physicalPath);
	                							   items python:here.portal_catalog.searchResults(portal_type=here.portal_type, Language='all', path={'query':path,'depth':1})"
	                		           tal:repeat="item items">
	                		
                                <li  tal:define="uid python:item.getObject().UID;
                                                 has_uid python:hasattr(item.aq_explicit, 'UID')">

                                    <input type="hidden"
                                           value=""
                                           id="link"
                                           name="link_language"
                                           tal:attributes="value python:lang[0]"/>	
                                    
                                    <input type="radio"
                                           class="noborder"
                                           name="link_content"
                                           id="link_content"
                                           tal:attributes="value uid;
                                                           id  uid;
                                                           checked python:content_language == lang[0]" />
                                                           
                                     <label tal:attributes="for uid" tal:content="item/Title">Der Titel des Artikels</label>                      
				                     [<a  tal:attributes="href item/getURL">view</a>]
				                     <span tal:content="item/Language"/>
	                                 
								</li>
							</tal:block>
							</ol>
						</tal:block>
	                </tal:item>
                </div>

            </div>

            <div class="formControls">
                <input class="context"
                       type="submit"
                       name="linkTranslation:method"
                       i18n:attributes="value label_link_translation;"
                       value="Link Translation"
                       />
            </div>

        </form>



    </div>

</body>
</html>
