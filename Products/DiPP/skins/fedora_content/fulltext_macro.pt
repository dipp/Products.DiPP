<html xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    i18n:domain="Plone">
    <body>
    
        <div metal:define-macro="metis"
             i18n:domain="dipp"
             tal:condition="python: pixel_domain and pixel_id"
             tal:define="pixel_domain here/pixel_domain|nothing;
                         pixel_id here/pixel_id|nothing;">
             
                   <img tal:define="vgwort_url string:http://$pixel_domain.met.vgwort.de/na/$pixel_id"
                        tal:attributes="src vgwort_url"
                        width="1" height="1" alt="" />
        </div>

        <div metal:define-macro="fulltext"
             i18n:domain="dipp"
             tal:define="articleFolder python:test(here.id == 'fulltext',here.getParentNode(),here);
                         path python:'/'.join(articleFolder.getPhysicalPath()); 
                         results python:here.portal_catalog(Type='Fedora Multimedia', path=path, getMMType='alternative_format', sort_on='getObjPositionInParent')"
             tal:condition="results">
             
            <h2 i18n:translate="heading_fulltext" i18n:domain="dipp" id="fulltext" name="fulltext">Fulltext</h2>
            
            <tal:block tal:repeat="result results">
                <tal:block tal:condition="python: result.id.endswith('pdf') and not result.id.startswith('srcdoc')"
                   tal:define="pixel_domain here/pixel_domain|nothing;
                               pixel_id here/pixel_id|nothing;
                               url python:result.getObject().absolute_url();
                               vgwort_url string:http://$pixel_domain.met.vgwort.de/na/$pixel_id?l=$url;
                               obj result/getObject;
                               size python:here.getObjSize(obj);
                               content_type obj/get_content_type|result/Format">
                    <p>
                        <a href=""
                           tal:attributes="href python:test(pixel_id,vgwort_url,url)">
                            <img src="" tal:attributes="src string:${portal_url}/pdf_icon.gif" alt="" />
                            <tal:block i18n:domain="dipp" i18n:translate="label_get_fulltext_as_pdf">
                            Volltext als <span i18n:name="pdf"><abbr i18n:domain="dipp" title="Portable Document Format">PDF</abbr></span>.
                            </tal:block>
                        </a>

                        <span class="discreet" i18n:domain="plone" >
                           (
                            <span i18n:translate="label_size">
                            Size
                            </span>

                            <span tal:condition="size"
                                tal:content="size">
                            257 KB
                            </span>

                            <span tal:condition="python:test(size,0,1)" i18n:translate="no_file_uploaded">
                              (No file has been uploaded yet)
                            </span>
                            )
                        </span>
                    </p>
                </tal:block>
            </tal:block>
        </div>
     </body>
</html>
