<html xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    metal:use-macro="here/dipp_workflow_template/macros/master">
    <metal:block fill-slot="base">
        <base href="" tal:attributes="href python: here.absolute_url() + '/'">
    </metal:block>

    <metal:block fill-slot="top_slot" tal:define="dummy python:request.set('disable_border',1)" />

    <body i18n:domain="dipp">


        <div metal:fill-slot="main"
             tal:define="journalPID here/fedora/PID|nothing">
        
            <div tal:condition="not:journalPID" class="portalMessage" i18n:translate="message_fedora_configuration">
                The connection to the Fedora Repository has not been configured yet. Go to the
                <a href="#" i18n:name="fedora_tool_url" tal:attributes="href string:portal_url/fedora/manage_config_form">Configuration page</a> to fix this.
            </div>
        
            <div metal:use-macro="here/document_actions/macros/document_actions">
                Document actions (print, sendto etc)
            </div>
        
            <h1 i18n:translate="heading_file_submit">
                Dokument - Dateiformular
            </h1>

    <a href=""
       class="link-parent"
       tal:attributes="href string: $portal_url/editorial_toolbox"
       i18n:translate="label_up_to_editorial_toolbox">
    Up to Editorial Toolbox
    </a>

            
                <form tal:condition="journalPID"
                      tal:attributes="action string:${here/absolute_url}/${template/id};"
                      tal:define="errors options/state/getErrors;
                                  qdc python:here.fedora.getQualifiedDCMetadata(None)"
                      method="post"
                      name="metadata_form"
                      id="metadata_form"
                      class="metadata"
                      encType="multipart/form-data">


                    <input type="hidden" name="form.submitted"  value="1" />
                    <input type="hidden" name="journalPID"      value="" tal:attributes="value journalPID" />
                    <input type="hidden" name="bc_journalTitle" value="" tal:attributes="value portal_properties/title|nothing" />
                    
          <fieldset>
            <legend i18n:translate="title">Titel</legend>
            <!-- TITLE -->
            <div class="field"
                 tal:define="error errors/title|nothing;
                             titles python:qdc['title'];
                             titleNumber python:len(titles);
                             newTitleNumber request/newTitleNumber|titleNumber"
                 tal:attributes="class python:test(error, 'field error', 'field')"
                 i18n:domain="qdc">

                <input type="hidden" name="newTitleNumber" value="" tal:attributes="value newTitleNumber"/>
                <input type="hidden" name="titleNumber" value="" tal:attributes="value titleNumber"/>

                <span class="fieldRequired" title="Required"
                       i18n:attributes="title"
                       i18n:translate="label_required">(Required)</span>
                <div tal:content="error">Validation error output</div>
                <table class="listing">
                    <tr>
                        <th i18n:translate="label_title">Titel</th>
                        <th i18n:translate="label_language">Sprache</th>
                    </tr>
                    <tr tal:repeat="title titles">
                        <td>
                            <input type="text"
                                   name="title_value:list"
                                   class="title"
                                   tal:define="i repeat/title/index;
                                               value python:title['value']"
                                   tal:attributes="value python: here.test('title_value',value,i)" />
                        </td>
                        <td tal:define="i repeat/title/index;
                                        lang python:title['lang']" 
                            tal:content="structure python:here.langList('title_lang:list',here.test('title_lang',lang,i))">
                            Sprachauswahlliste
                            <input type="text"
                                   class="language"
                                   name="title_lang:list"
                                   tal:define="i repeat/title/index;
                                               value python:title['lang']"
                                   tal:attributes="value python: here.test('title_lang',value,i)" />
                        </td>
                    </tr>
                </table>

            </div>

          </fieldset>

          <fieldset>
            <legend i18n:translate="label_file">Dokument-Datei</legend>
                    
                    <div class="field"
                        tal:define="error errors/file|nothing;
                                    file request/file|nothing"
                        tal:attributes="class python:test(error, 'field error', 'field')"
                        >


                        <span class="fieldRequired" title="Required"
                               i18n:attributes="title"
                               i18n:translate="label_required">(Required)</span>
                        <div tal:content="error">Validation error output</div>
                        <div class="formHelp" i18n:domain="dipp" i18n:translate="help_file">
                            Wählen Sie  den Artikel im RTF, PDF oder XML (docbook) Format aus.
                        </div>

                        <!-- Dateivorauswahl aus SicherheitsgrŸnden nicht mšglich, vgl. http://de.selfhtml.org/html/formulare/datei_upload.htm  -->
                        <input type="file" class="file" id="file" name="file"  size="50"/>




                    </div>

          </fieldset>


                    <input class="context"
                           tabindex=""
                           type="submit"
                           name="form.button.testconvert"
                           value="Testkonvertieren"
                           i18n:domain="dipp"
                           i18n:attributes="value label_test_online_transformation;
                                            title help_testUpload;"
                           tal:attributes="tabindex tabindex/next;
                                           disabled python:test(isLocked, 'disabled', None);" />
                    <input class="context"
                           tabindex=""
                           type="submit"
                           name="form.button.metadata"
                           value="weiter mit Metadaten"
                           i18n:domain="dipp"
                           i18n:attributes="value label_proceed_with_metadata;
                                            title help_fullUpload;"
                           tal:attributes="tabindex tabindex/next;
                                           disabled python:test(isLocked, 'disabled', None);" />

                    <input class="standalone"
                           tabindex=""
                           type="submit"
                           name="form.button.Cancel"
                           value="Cancel"
                           i18n:domain="dipp"
                           i18n:attributes="value label_cancel;"
                           tal:attributes="tabindex tabindex/next;" />
                </form>
        </div>
    </body>
</html>
